(base) jinfang@user-MZ72-HB2-00:~/project/new_CarotidPlaqueStabilityClassification$ ./train.sh 
使用设备: cuda
✓ 随机种子设置为: 42

✓ 创建输出文件夹: ./output/train_20251222_193941


============================================================
加载数据集...
============================================================
跳过 孙宝忠: 不在标签文件中
跳过 谢岐山: 不在标签文件中
跳过 陈会友: 不在标签文件中
跳过 朱岳平: 不在标签文件中
跳过 眭卫国: 不在标签文件中
============================================================
数据加载统计:
============================================================
✓ 成功加载: 380 个样本
✗ 跳过样本: 2 个 (图片数 < 100)
每个样本保留: 100 张图片

跳过的样本详情:
  ✗ 王翠霞            :   96 张 | Label: 1
  ✗ 赵明庚            :   67 张 | Label: 0

类别分布: Label 0: 209 个  Label 1: 171 个  
============================================================

数据集划分:
  训练集: 304 样本
  验证集: 38 样本
  测试集: 38 样本

============================================================
创建模型...
============================================================
正在加载预训练模型: ./weights/resnet_18_23dataset.pth
✓ 成功加载 102 个预训练权重
冻结骨干网络参数...
✓ 冻结了 60 个参数
可训练参数: 165,250 / 33,325,250 (0.50%)
类别分布: 负类=169, 正类=135
基础权重: [0.8994082840236687, 1.125925925925926]
最终权重（含手动系数）: [0.8994083 1.351111 ] (neg_scale=1.0, pos_scale=1.2)

============================================================
评估第0轮（初始）性能...
============================================================
第0轮（初始）:
  训练集 Loss: 35.9568
  验证集 Loss: 40.6454
  验证集 Acc:  0.4737
============================================================


============================================================
开始训练...
============================================================


Epoch 1/100
------------------------------------------------------------

训练 - Loss: 5.3684, Acc: 0.4441
验证 - Loss: 2.4461, Acc: 0.5000, F1: 0.0952, AUC: 0.6278
测试（本轮） - Acc: 0.5789, F1: 0.0000, AUC: 0.5483 , Recall: 0.0000, Precision: 0.0000
✓ 保存最佳模型 (验证准确率: 0.5000)

Epoch 2/100
------------------------------------------------------------

训练 - Loss: 3.8998, Acc: 0.5197
验证 - Loss: 1.1041, Acc: 0.4211, F1: 0.4762, AUC: 0.3639
测试（本轮） - Acc: 0.5000, F1: 0.5366, AUC: 0.6037 , Recall: 0.6875, Precision: 0.4400

Epoch 3/100
------------------------------------------------------------

训练 - Loss: 4.2016, Acc: 0.5197
验证 - Loss: 2.2627, Acc: 0.3947, F1: 0.3429, AUC: 0.4389
测试（本轮） - Acc: 0.6053, F1: 0.2857, AUC: 0.5028 , Recall: 0.1875, Precision: 0.6000

Epoch 4/100
------------------------------------------------------------

训练 - Loss: 3.2438, Acc: 0.4803
验证 - Loss: 0.5501, Acc: 0.7368, F1: 0.7826, AUC: 0.7750
测试（本轮） - Acc: 0.5789, F1: 0.6000, AUC: 0.6648 , Recall: 0.7500, Precision: 0.5000
✓ 保存最佳模型 (验证准确率: 0.7368)

Epoch 5/100
------------------------------------------------------------

训练 - Loss: 2.7939, Acc: 0.5197
验证 - Loss: 1.1939, Acc: 0.5263, F1: 0.6400, AUC: 0.5222
测试（本轮） - Acc: 0.4737, F1: 0.4444, AUC: 0.4261 , Recall: 0.5000, Precision: 0.4000

Epoch 6/100
------------------------------------------------------------

训练 - Loss: 2.5465, Acc: 0.5000
验证 - Loss: 1.2538, Acc: 0.3684, F1: 0.3333, AUC: 0.3528
测试（本轮） - Acc: 0.5263, F1: 0.2500, AUC: 0.4460 , Recall: 0.1875, Precision: 0.3750

Epoch 7/100
------------------------------------------------------------

训练 - Loss: 2.2040, Acc: 0.5000
验证 - Loss: 1.3340, Acc: 0.5000, F1: 0.6415, AUC: 0.3417
测试（本轮） - Acc: 0.4211, F1: 0.3889, AUC: 0.4034 , Recall: 0.4375, Precision: 0.3500

Epoch 8/100
------------------------------------------------------------

训练 - Loss: 1.7392, Acc: 0.5230
验证 - Loss: 1.0648, Acc: 0.4474, F1: 0.2222, AUC: 0.4194
测试（本轮） - Acc: 0.5526, F1: 0.4516, AUC: 0.5710 , Recall: 0.4375, Precision: 0.4667

Epoch 9/100
------------------------------------------------------------

训练 - Loss: 1.7468, Acc: 0.4934
验证 - Loss: 1.1854, Acc: 0.4474, F1: 0.2222, AUC: 0.3528
测试（本轮） - Acc: 0.5263, F1: 0.4706, AUC: 0.5994 , Recall: 0.5000, Precision: 0.4444

Epoch 10/100
------------------------------------------------------------

训练 - Loss: 1.7159, Acc: 0.4342
验证 - Loss: 0.8194, Acc: 0.4211, F1: 0.0833, AUC: 0.4528
测试（本轮） - Acc: 0.6053, F1: 0.2105, AUC: 0.6364 , Recall: 0.1250, Precision: 0.6667

Epoch 11/100
------------------------------------------------------------

训练 - Loss: 1.6202, Acc: 0.4638
验证 - Loss: 0.7510, Acc: 0.5263, F1: 0.2500, AUC: 0.6889
测试（本轮） - Acc: 0.6316, F1: 0.5000, AUC: 0.7131 , Recall: 0.4375, Precision: 0.5833

Epoch 12/100
------------------------------------------------------------

训练 - Loss: 1.1696, Acc: 0.5230
验证 - Loss: 0.7660, Acc: 0.4737, F1: 0.5833, AUC: 0.4944
测试（本轮） - Acc: 0.6842, F1: 0.6667, AUC: 0.6761 , Recall: 0.7500, Precision: 0.6000
✓ 保存检测到的模型检查点: ./output/train_20251222_193941/models/best_model_11.pth

Epoch 13/100
------------------------------------------------------------

训练 - Loss: 1.2074, Acc: 0.5526
验证 - Loss: 0.6518, Acc: 0.5263, F1: 0.4375, AUC: 0.6028
测试（本轮） - Acc: 0.6316, F1: 0.5333, AUC: 0.6619 , Recall: 0.5000, Precision: 0.5714

Epoch 14/100
------------------------------------------------------------

训练 - Loss: 1.0418, Acc: 0.5428
验证 - Loss: 0.5818, Acc: 0.6579, F1: 0.7347, AUC: 0.7389
测试（本轮） - Acc: 0.4474, F1: 0.5714, AUC: 0.6534 , Recall: 0.8750, Precision: 0.4242

Epoch 15/100
------------------------------------------------------------

训练 - Loss: 1.0814, Acc: 0.5428
验证 - Loss: 0.6608, Acc: 0.4474, F1: 0.4615, AUC: 0.5278
测试（本轮） - Acc: 0.6316, F1: 0.5882, AUC: 0.6790 , Recall: 0.6250, Precision: 0.5556
✓ 保存检测到的模型检查点: ./output/train_20251222_193941/models/best_model_14.pth

Epoch 16/100
------------------------------------------------------------

训练 - Loss: 1.0656, Acc: 0.5066
验证 - Loss: 0.6065, Acc: 0.6053, F1: 0.7170, AUC: 0.7944
测试（本轮） - Acc: 0.5000, F1: 0.5778, AUC: 0.4744 , Recall: 0.8125, Precision: 0.4483

Epoch 17/100
------------------------------------------------------------

训练 - Loss: 0.9875, Acc: 0.4539
验证 - Loss: 0.6223, Acc: 0.6842, F1: 0.7692, AUC: 0.7278
测试（本轮） - Acc: 0.3421, F1: 0.4186, AUC: 0.4148 , Recall: 0.5625, Precision: 0.3333

Epoch 18/100
------------------------------------------------------------

训练 - Loss: 0.8890, Acc: 0.4539
验证 - Loss: 0.9853, Acc: 0.4211, F1: 0.4762, AUC: 0.3722
测试（本轮） - Acc: 0.4474, F1: 0.1600, AUC: 0.3239 , Recall: 0.1250, Precision: 0.2222

Epoch 19/100
------------------------------------------------------------

训练 - Loss: 0.9415, Acc: 0.4309
验证 - Loss: 0.7325, Acc: 0.3684, F1: 0.4000, AUC: 0.3778
测试（本轮） - Acc: 0.5263, F1: 0.5263, AUC: 0.6051 , Recall: 0.6250, Precision: 0.4545

Epoch 20/100
------------------------------------------------------------

训练 - Loss: 0.8993, Acc: 0.4605
验证 - Loss: 0.6736, Acc: 0.5263, F1: 0.6538, AUC: 0.6583
测试（本轮） - Acc: 0.4474, F1: 0.4878, AUC: 0.4432 , Recall: 0.6250, Precision: 0.4000

Epoch 21/100
------------------------------------------------------------

训练 - Loss: 0.7608, Acc: 0.5296
验证 - Loss: 0.7069, Acc: 0.4474, F1: 0.1600, AUC: 0.4639
测试（本轮） - Acc: 0.5263, F1: 0.3077, AUC: 0.4602 , Recall: 0.2500, Precision: 0.4000

Epoch 22/100
------------------------------------------------------------

训练 - Loss: 0.8542, Acc: 0.4704
验证 - Loss: 0.9594, Acc: 0.5000, F1: 0.4865, AUC: 0.4667
测试（本轮） - Acc: 0.5263, F1: 0.1000, AUC: 0.3665 , Recall: 0.0625, Precision: 0.2500

Epoch 23/100
------------------------------------------------------------

训练 - Loss: 0.8227, Acc: 0.4704
验证 - Loss: 0.6950, Acc: 0.3684, F1: 0.4545, AUC: 0.3472
测试（本轮） - Acc: 0.5526, F1: 0.5641, AUC: 0.6051 , Recall: 0.6875, Precision: 0.4783

Epoch 24/100
------------------------------------------------------------

训练 - Loss: 0.8034, Acc: 0.4868
验证 - Loss: 0.6669, Acc: 0.5263, F1: 0.6897, AUC: 0.3333
测试（本轮） - Acc: 0.4211, F1: 0.5926, AUC: 0.6420 , Recall: 1.0000, Precision: 0.4211

Epoch 25/100
------------------------------------------------------------

训练 - Loss: 0.8016, Acc: 0.4539
验证 - Loss: 0.7120, Acc: 0.5526, F1: 0.7018, AUC: 0.3833
测试（本轮） - Acc: 0.4211, F1: 0.5926, AUC: 0.6761 , Recall: 1.0000, Precision: 0.4211

Epoch 26/100
------------------------------------------------------------

训练 - Loss: 0.7661, Acc: 0.5296
验证 - Loss: 0.6641, Acc: 0.5263, F1: 0.6667, AUC: 0.4194
测试（本轮） - Acc: 0.5263, F1: 0.5714, AUC: 0.6705 , Recall: 0.7500, Precision: 0.4615

Epoch 27/100
------------------------------------------------------------

训练 - Loss: 0.7565, Acc: 0.4638
验证 - Loss: 0.6285, Acc: 0.6053, F1: 0.7273, AUC: 0.5972
测试（本轮） - Acc: 0.5000, F1: 0.6122, AUC: 0.7102 , Recall: 0.9375, Precision: 0.4545

Epoch 28/100
------------------------------------------------------------

训练 - Loss: 0.7689, Acc: 0.4638
验证 - Loss: 0.6496, Acc: 0.5263, F1: 0.6538, AUC: 0.3972
测试（本轮） - Acc: 0.5263, F1: 0.5714, AUC: 0.6619 , Recall: 0.7500, Precision: 0.4615

Epoch 29/100
------------------------------------------------------------

训练 - Loss: 0.7163, Acc: 0.5099
验证 - Loss: 0.6635, Acc: 0.5526, F1: 0.7018, AUC: 0.4222
测试（本轮） - Acc: 0.5000, F1: 0.6122, AUC: 0.6960 , Recall: 0.9375, Precision: 0.4545

Epoch 30/100
------------------------------------------------------------

训练 - Loss: 0.7456, Acc: 0.4309
验证 - Loss: 0.6419, Acc: 0.6053, F1: 0.7059, AUC: 0.5528
测试（本轮） - Acc: 0.6579, F1: 0.6486, AUC: 0.6989 , Recall: 0.7500, Precision: 0.5714
✓ 保存检测到的模型检查点: ./output/train_20251222_193941/models/best_model_29.pth

Epoch 31/100
------------------------------------------------------------

训练 - Loss: 0.7290, Acc: 0.4967
验证 - Loss: 0.6319, Acc: 0.5789, F1: 0.6923, AUC: 0.5722
测试（本轮） - Acc: 0.5263, F1: 0.5909, AUC: 0.6449 , Recall: 0.8125, Precision: 0.4643

Epoch 32/100
------------------------------------------------------------

训练 - Loss: 0.7382, Acc: 0.4934
验证 - Loss: 0.8313, Acc: 0.5263, F1: 0.6538, AUC: 0.3667
测试（本轮） - Acc: 0.3684, F1: 0.4286, AUC: 0.4489 , Recall: 0.5625, Precision: 0.3462

Epoch 33/100
------------------------------------------------------------

训练 - Loss: 0.7275, Acc: 0.4375
验证 - Loss: 0.6551, Acc: 0.5526, F1: 0.6667, AUC: 0.4278
测试（本轮） - Acc: 0.5789, F1: 0.5789, AUC: 0.6989 , Recall: 0.6875, Precision: 0.5000

Epoch 34/100
------------------------------------------------------------

训练 - Loss: 0.6984, Acc: 0.4836
验证 - Loss: 0.6607, Acc: 0.5526, F1: 0.6909, AUC: 0.5306
测试（本轮） - Acc: 0.5000, F1: 0.5957, AUC: 0.6392 , Recall: 0.8750, Precision: 0.4516

Epoch 35/100
------------------------------------------------------------

训练 - Loss: 0.7246, Acc: 0.4704
验证 - Loss: 0.6719, Acc: 0.5263, F1: 0.6087, AUC: 0.4889
测试（本轮） - Acc: 0.6053, F1: 0.5946, AUC: 0.6705 , Recall: 0.6875, Precision: 0.5238

Epoch 36/100
------------------------------------------------------------

训练 - Loss: 0.7159, Acc: 0.4967
验证 - Loss: 0.6479, Acc: 0.4737, F1: 0.5833, AUC: 0.4306
测试（本轮） - Acc: 0.6053, F1: 0.6341, AUC: 0.6932 , Recall: 0.8125, Precision: 0.5200
✓ 保存检测到的模型检查点: ./output/train_20251222_193941/models/best_model_35.pth

Epoch 37/100
------------------------------------------------------------

训练 - Loss: 0.7178, Acc: 0.4572
验证 - Loss: 0.6398, Acc: 0.5263, F1: 0.6897, AUC: 0.5306
测试（本轮） - Acc: 0.4211, F1: 0.5926, AUC: 0.7585 , Recall: 1.0000, Precision: 0.4211

Epoch 38/100
------------------------------------------------------------

训练 - Loss: 0.7060, Acc: 0.4638
验证 - Loss: 0.6615, Acc: 0.6579, F1: 0.7347, AUC: 0.5306
测试（本轮） - Acc: 0.6842, F1: 0.6471, AUC: 0.7472 , Recall: 0.6875, Precision: 0.6111
✓ 保存检测到的模型检查点: ./output/train_20251222_193941/models/best_model_37.pth

Epoch 39/100
------------------------------------------------------------

训练 - Loss: 0.7101, Acc: 0.4408
验证 - Loss: 0.6751, Acc: 0.6053, F1: 0.7273, AUC: 0.5278
测试（本轮） - Acc: 0.5789, F1: 0.6000, AUC: 0.6903 , Recall: 0.7500, Precision: 0.5000

Epoch 40/100
------------------------------------------------------------

训练 - Loss: 0.7315, Acc: 0.4441
验证 - Loss: 0.6658, Acc: 0.5526, F1: 0.7018, AUC: 0.4722
测试（本轮） - Acc: 0.4211, F1: 0.5600, AUC: 0.6648 , Recall: 0.8750, Precision: 0.4118

Epoch 41/100
------------------------------------------------------------

训练 - Loss: 0.7165, Acc: 0.4671
验证 - Loss: 0.6548, Acc: 0.5000, F1: 0.6122, AUC: 0.4583
测试（本轮） - Acc: 0.6842, F1: 0.6667, AUC: 0.7330 , Recall: 0.7500, Precision: 0.6000
✓ 保存检测到的模型检查点: ./output/train_20251222_193941/models/best_model_40.pth

Epoch 42/100
------------------------------------------------------------

训练 - Loss: 0.6841, Acc: 0.4737
验证 - Loss: 0.6515, Acc: 0.5263, F1: 0.6897, AUC: 0.4556
测试（本轮） - Acc: 0.4737, F1: 0.6154, AUC: 0.6932 , Recall: 1.0000, Precision: 0.4444

Epoch 43/100
------------------------------------------------------------

训练 - Loss: 0.6971, Acc: 0.4638
验证 - Loss: 0.6523, Acc: 0.6053, F1: 0.7170, AUC: 0.4917
测试（本轮） - Acc: 0.5000, F1: 0.5957, AUC: 0.7131 , Recall: 0.8750, Precision: 0.4516

Epoch 44/100
------------------------------------------------------------

训练 - Loss: 0.7022, Acc: 0.5066
验证 - Loss: 0.6516, Acc: 0.5526, F1: 0.6792, AUC: 0.5028
测试（本轮） - Acc: 0.6053, F1: 0.6341, AUC: 0.7017 , Recall: 0.8125, Precision: 0.5200

Epoch 45/100
------------------------------------------------------------

训练 - Loss: 0.6971, Acc: 0.4572
验证 - Loss: 0.6577, Acc: 0.6053, F1: 0.6939, AUC: 0.5639
测试（本轮） - Acc: 0.6316, F1: 0.6111, AUC: 0.6733 , Recall: 0.6875, Precision: 0.5500

Epoch 46/100
------------------------------------------------------------

训练 - Loss: 0.6941, Acc: 0.5164
验证 - Loss: 0.6557, Acc: 0.6579, F1: 0.7547, AUC: 0.7139
测试（本轮） - Acc: 0.5263, F1: 0.6250, AUC: 0.6136 , Recall: 0.9375, Precision: 0.4688

Epoch 47/100
------------------------------------------------------------

训练 - Loss: 0.6952, Acc: 0.4934
验证 - Loss: 0.6444, Acc: 0.6053, F1: 0.7273, AUC: 0.6250
测试（本轮） - Acc: 0.5000, F1: 0.6275, AUC: 0.6733 , Recall: 1.0000, Precision: 0.4571

Epoch 48/100
------------------------------------------------------------

训练 - Loss: 0.6900, Acc: 0.4934
验证 - Loss: 0.6653, Acc: 0.5789, F1: 0.7037, AUC: 0.5694
测试（本轮） - Acc: 0.5526, F1: 0.6383, AUC: 0.6989 , Recall: 0.9375, Precision: 0.4839

Epoch 49/100
------------------------------------------------------------

训练 - Loss: 0.7151, Acc: 0.4605
验证 - Loss: 0.6501, Acc: 0.5263, F1: 0.6897, AUC: 0.4139
测试（本轮） - Acc: 0.4211, F1: 0.5926, AUC: 0.6477 , Recall: 1.0000, Precision: 0.4211

Epoch 50/100
------------------------------------------------------------

训练 - Loss: 0.6906, Acc: 0.4770
验证 - Loss: 0.6456, Acc: 0.5526, F1: 0.7018, AUC: 0.5167
测试（本轮） - Acc: 0.5263, F1: 0.6400, AUC: 0.6733 , Recall: 1.0000, Precision: 0.4706

Epoch 51/100
------------------------------------------------------------

训练 - Loss: 0.7060, Acc: 0.4605
验证 - Loss: 0.6527, Acc: 0.5526, F1: 0.6909, AUC: 0.5056
测试（本轮） - Acc: 0.4737, F1: 0.5652, AUC: 0.6619 , Recall: 0.8125, Precision: 0.4333

Epoch 52/100
------------------------------------------------------------

训练 - Loss: 0.6996, Acc: 0.4770
验证 - Loss: 0.6717, Acc: 0.5526, F1: 0.7018, AUC: 0.5500
测试（本轮） - Acc: 0.4737, F1: 0.6000, AUC: 0.5852 , Recall: 0.9375, Precision: 0.4412

Epoch 53/100
------------------------------------------------------------

训练 - Loss: 0.6895, Acc: 0.5033
验证 - Loss: 0.6546, Acc: 0.5263, F1: 0.6897, AUC: 0.4944
测试（本轮） - Acc: 0.4211, F1: 0.5926, AUC: 0.6648 , Recall: 1.0000, Precision: 0.4211

Epoch 54/100
------------------------------------------------------------

训练 - Loss: 0.6882, Acc: 0.4770
验证 - Loss: 0.6591, Acc: 0.5789, F1: 0.7143, AUC: 0.5306
测试（本轮） - Acc: 0.4211, F1: 0.5217, AUC: 0.6420 , Recall: 0.7500, Precision: 0.4000

Epoch 55/100
------------------------------------------------------------

训练 - Loss: 0.6868, Acc: 0.4638
验证 - Loss: 0.6406, Acc: 0.6053, F1: 0.7273, AUC: 0.6139
测试（本轮） - Acc: 0.4474, F1: 0.5714, AUC: 0.6420 , Recall: 0.8750, Precision: 0.4242

Epoch 56/100
------------------------------------------------------------

训练 - Loss: 0.6883, Acc: 0.4901
验证 - Loss: 0.6870, Acc: 0.5526, F1: 0.6792, AUC: 0.4861
测试（本轮） - Acc: 0.4474, F1: 0.4000, AUC: 0.5085 , Recall: 0.4375, Precision: 0.3684

Epoch 57/100
------------------------------------------------------------

训练 - Loss: 0.6988, Acc: 0.4441
验证 - Loss: 0.6519, Acc: 0.5263, F1: 0.6897, AUC: 0.5361
测试（本轮） - Acc: 0.4474, F1: 0.6038, AUC: 0.6534 , Recall: 1.0000, Precision: 0.4324

Epoch 58/100
------------------------------------------------------------

训练 - Loss: 0.6874, Acc: 0.5132
验证 - Loss: 0.6744, Acc: 0.5000, F1: 0.6545, AUC: 0.5000
测试（本轮） - Acc: 0.4737, F1: 0.5455, AUC: 0.6847 , Recall: 0.7500, Precision: 0.4286

Epoch 59/100
------------------------------------------------------------

训练 - Loss: 0.7036, Acc: 0.4803
验证 - Loss: 0.6696, Acc: 0.5789, F1: 0.7037, AUC: 0.8278
测试（本轮） - Acc: 0.3421, F1: 0.5098, AUC: 0.5597 , Recall: 0.8125, Precision: 0.3714

Epoch 60/100
------------------------------------------------------------

训练 - Loss: 0.6878, Acc: 0.5066
验证 - Loss: 0.6751, Acc: 0.5526, F1: 0.6909, AUC: 0.8667
测试（本轮） - Acc: 0.3421, F1: 0.4681, AUC: 0.4972 , Recall: 0.6875, Precision: 0.3548

Epoch 61/100
------------------------------------------------------------

训练 - Loss: 0.6903, Acc: 0.4737
验证 - Loss: 0.6385, Acc: 0.5263, F1: 0.6786, AUC: 0.6833
测试（本轮） - Acc: 0.3947, F1: 0.5660, AUC: 0.5795 , Recall: 0.9375, Precision: 0.4054

Epoch 62/100
------------------------------------------------------------

训练 - Loss: 0.6950, Acc: 0.4803
验证 - Loss: 0.6648, Acc: 0.5789, F1: 0.7143, AUC: 0.6778
测试（本轮） - Acc: 0.4474, F1: 0.5532, AUC: 0.5653 , Recall: 0.8125, Precision: 0.4194

Epoch 63/100
------------------------------------------------------------

训练 - Loss: 0.6776, Acc: 0.4671
验证 - Loss: 0.6430, Acc: 0.5263, F1: 0.6897, AUC: 0.5889
测试（本轮） - Acc: 0.4211, F1: 0.5926, AUC: 0.6080 , Recall: 1.0000, Precision: 0.4211

Epoch 64/100
------------------------------------------------------------

训练 - Loss: 0.6825, Acc: 0.4704
验证 - Loss: 0.6360, Acc: 0.5263, F1: 0.6897, AUC: 0.6639
测试（本轮） - Acc: 0.4211, F1: 0.5926, AUC: 0.6080 , Recall: 1.0000, Precision: 0.4211

Epoch 65/100
------------------------------------------------------------

训练 - Loss: 0.6870, Acc: 0.5164
验证 - Loss: 0.6304, Acc: 0.6316, F1: 0.7308, AUC: 0.8083
测试（本轮） - Acc: 0.4211, F1: 0.5600, AUC: 0.6307 , Recall: 0.8750, Precision: 0.4118

Epoch 66/100
------------------------------------------------------------

训练 - Loss: 0.7024, Acc: 0.4770
验证 - Loss: 0.6384, Acc: 0.6053, F1: 0.7273, AUC: 0.7528
测试（本轮） - Acc: 0.4211, F1: 0.5769, AUC: 0.6023 , Recall: 0.9375, Precision: 0.4167

Epoch 67/100
------------------------------------------------------------

训练 - Loss: 0.6827, Acc: 0.4737
验证 - Loss: 0.6463, Acc: 0.5263, F1: 0.6897, AUC: 0.5694
测试（本轮） - Acc: 0.4211, F1: 0.5926, AUC: 0.6619 , Recall: 1.0000, Precision: 0.4211

Epoch 68/100
------------------------------------------------------------

训练 - Loss: 0.6977, Acc: 0.4770
验证 - Loss: 0.6455, Acc: 0.5789, F1: 0.7143, AUC: 0.6194
测试（本轮） - Acc: 0.5263, F1: 0.6400, AUC: 0.6790 , Recall: 1.0000, Precision: 0.4706

Epoch 69/100
------------------------------------------------------------

训练 - Loss: 0.6979, Acc: 0.4704
验证 - Loss: 0.6503, Acc: 0.5263, F1: 0.6897, AUC: 0.6083
测试（本轮） - Acc: 0.4211, F1: 0.5926, AUC: 0.7102 , Recall: 1.0000, Precision: 0.4211

Epoch 70/100
------------------------------------------------------------

训练 - Loss: 0.6876, Acc: 0.4803
验证 - Loss: 0.6416, Acc: 0.5526, F1: 0.7018, AUC: 0.5667
测试（本轮） - Acc: 0.4211, F1: 0.5926, AUC: 0.6335 , Recall: 1.0000, Precision: 0.4211

Epoch 71/100
------------------------------------------------------------

训练 - Loss: 0.6907, Acc: 0.4507
验证 - Loss: 0.6511, Acc: 0.5263, F1: 0.6897, AUC: 0.5583
测试（本轮） - Acc: 0.4474, F1: 0.6038, AUC: 0.7102 , Recall: 1.0000, Precision: 0.4324

Epoch 72/100
------------------------------------------------------------

训练 - Loss: 0.6949, Acc: 0.4243
验证 - Loss: 0.6526, Acc: 0.5526, F1: 0.7018, AUC: 0.5861
测试（本轮） - Acc: 0.4211, F1: 0.5926, AUC: 0.7330 , Recall: 1.0000, Precision: 0.4211

Epoch 73/100
------------------------------------------------------------

训练 - Loss: 0.6884, Acc: 0.5033
验证 - Loss: 0.6569, Acc: 0.5789, F1: 0.7143, AUC: 0.6278
测试（本轮） - Acc: 0.5526, F1: 0.6383, AUC: 0.7045 , Recall: 0.9375, Precision: 0.4839

Epoch 74/100
------------------------------------------------------------

训练 - Loss: 0.6945, Acc: 0.5000
验证 - Loss: 0.6451, Acc: 0.5789, F1: 0.7143, AUC: 0.6222
测试（本轮） - Acc: 0.5263, F1: 0.6250, AUC: 0.6818 , Recall: 0.9375, Precision: 0.4688

Epoch 75/100
------------------------------------------------------------

训练 - Loss: 0.6756, Acc: 0.5296
验证 - Loss: 0.6484, Acc: 0.5263, F1: 0.6897, AUC: 0.4472
测试（本轮） - Acc: 0.4474, F1: 0.6038, AUC: 0.6165 , Recall: 1.0000, Precision: 0.4324

Epoch 76/100
------------------------------------------------------------

训练 - Loss: 0.6954, Acc: 0.4737
验证 - Loss: 0.6399, Acc: 0.5263, F1: 0.6897, AUC: 0.5278
测试（本轮） - Acc: 0.4211, F1: 0.5769, AUC: 0.6364 , Recall: 0.9375, Precision: 0.4167

Epoch 77/100
------------------------------------------------------------

训练 - Loss: 0.6894, Acc: 0.4671
验证 - Loss: 0.6436, Acc: 0.5263, F1: 0.6897, AUC: 0.4917
测试（本轮） - Acc: 0.4211, F1: 0.5926, AUC: 0.6278 , Recall: 1.0000, Precision: 0.4211

Epoch 78/100
------------------------------------------------------------

训练 - Loss: 0.6913, Acc: 0.5000
验证 - Loss: 0.6434, Acc: 0.5263, F1: 0.6897, AUC: 0.5278
测试（本轮） - Acc: 0.4474, F1: 0.6038, AUC: 0.6023 , Recall: 1.0000, Precision: 0.4324

Epoch 79/100
------------------------------------------------------------

训练 - Loss: 0.6888, Acc: 0.4901
验证 - Loss: 0.6445, Acc: 0.5526, F1: 0.7018, AUC: 0.5861
测试（本轮） - Acc: 0.4474, F1: 0.6038, AUC: 0.5625 , Recall: 1.0000, Precision: 0.4324

Epoch 80/100
------------------------------------------------------------

训练 - Loss: 0.6994, Acc: 0.5132
验证 - Loss: 0.6418, Acc: 0.5789, F1: 0.7037, AUC: 0.7389
测试（本轮） - Acc: 0.3947, F1: 0.5306, AUC: 0.6364 , Recall: 0.8125, Precision: 0.3939

Epoch 81/100
------------------------------------------------------------

训练 - Loss: 0.6837, Acc: 0.4901
验证 - Loss: 0.6471, Acc: 0.5526, F1: 0.7018, AUC: 0.6250
测试（本轮） - Acc: 0.4211, F1: 0.5926, AUC: 0.6335 , Recall: 1.0000, Precision: 0.4211

Epoch 82/100
------------------------------------------------------------

训练 - Loss: 0.6914, Acc: 0.4803
验证 - Loss: 0.6445, Acc: 0.5526, F1: 0.7018, AUC: 0.7139
测试（本轮） - Acc: 0.4474, F1: 0.6038, AUC: 0.6193 , Recall: 1.0000, Precision: 0.4324

Epoch 83/100
------------------------------------------------------------

训练 - Loss: 0.6912, Acc: 0.5099
验证 - Loss: 0.6379, Acc: 0.5526, F1: 0.7018, AUC: 0.6556
测试（本轮） - Acc: 0.3947, F1: 0.5660, AUC: 0.5653 , Recall: 0.9375, Precision: 0.4054

Epoch 84/100
------------------------------------------------------------

训练 - Loss: 0.6901, Acc: 0.4967
验证 - Loss: 0.6309, Acc: 0.6053, F1: 0.7273, AUC: 0.7222
测试（本轮） - Acc: 0.3947, F1: 0.5490, AUC: 0.5795 , Recall: 0.8750, Precision: 0.4000

Epoch 85/100
------------------------------------------------------------

训练 - Loss: 0.6758, Acc: 0.4967
验证 - Loss: 0.6430, Acc: 0.5526, F1: 0.7018, AUC: 0.6583
测试（本轮） - Acc: 0.3947, F1: 0.5490, AUC: 0.5852 , Recall: 0.8750, Precision: 0.4000

Epoch 86/100
------------------------------------------------------------

训练 - Loss: 0.6795, Acc: 0.5000
验证 - Loss: 0.6384, Acc: 0.5526, F1: 0.7018, AUC: 0.6528
测试（本轮） - Acc: 0.3947, F1: 0.5490, AUC: 0.5909 , Recall: 0.8750, Precision: 0.4000

Epoch 87/100
------------------------------------------------------------

训练 - Loss: 0.6886, Acc: 0.4638
验证 - Loss: 0.6427, Acc: 0.5526, F1: 0.7018, AUC: 0.6528
测试（本轮） - Acc: 0.4474, F1: 0.6038, AUC: 0.5710 , Recall: 1.0000, Precision: 0.4324

Epoch 88/100
------------------------------------------------------------

训练 - Loss: 0.6929, Acc: 0.5000
验证 - Loss: 0.6431, Acc: 0.5526, F1: 0.7018, AUC: 0.6083
测试（本轮） - Acc: 0.4474, F1: 0.6038, AUC: 0.6222 , Recall: 1.0000, Precision: 0.4324

Epoch 89/100
------------------------------------------------------------

训练 - Loss: 0.6912, Acc: 0.4704
验证 - Loss: 0.6384, Acc: 0.5526, F1: 0.7018, AUC: 0.6250
测试（本轮） - Acc: 0.4474, F1: 0.6038, AUC: 0.5909 , Recall: 1.0000, Precision: 0.4324

Epoch 90/100
------------------------------------------------------------

训练 - Loss: 0.6871, Acc: 0.4967
验证 - Loss: 0.6360, Acc: 0.6053, F1: 0.7273, AUC: 0.6833
测试（本轮） - Acc: 0.3947, F1: 0.5490, AUC: 0.5852 , Recall: 0.8750, Precision: 0.4000

Epoch 91/100
------------------------------------------------------------

训练 - Loss: 0.6812, Acc: 0.4967
验证 - Loss: 0.6343, Acc: 0.5789, F1: 0.7143, AUC: 0.6806
测试（本轮） - Acc: 0.3947, F1: 0.5490, AUC: 0.5795 , Recall: 0.8750, Precision: 0.4000

Epoch 92/100
------------------------------------------------------------

训练 - Loss: 0.6956, Acc: 0.4901
验证 - Loss: 0.6356, Acc: 0.6053, F1: 0.7273, AUC: 0.7028
测试（本轮） - Acc: 0.3947, F1: 0.5660, AUC: 0.6023 , Recall: 0.9375, Precision: 0.4054

Epoch 93/100
------------------------------------------------------------

训练 - Loss: 0.6786, Acc: 0.5526
验证 - Loss: 0.6531, Acc: 0.5789, F1: 0.7143, AUC: 0.6694
测试（本轮） - Acc: 0.5000, F1: 0.6275, AUC: 0.6193 , Recall: 1.0000, Precision: 0.4571

Epoch 94/100
------------------------------------------------------------

训练 - Loss: 0.6894, Acc: 0.4770
验证 - Loss: 0.6370, Acc: 0.5789, F1: 0.7143, AUC: 0.6889
测试（本轮） - Acc: 0.3684, F1: 0.5385, AUC: 0.5739 , Recall: 0.8750, Precision: 0.3889

Epoch 95/100
------------------------------------------------------------

训练 - Loss: 0.6815, Acc: 0.5099
验证 - Loss: 0.6333, Acc: 0.5789, F1: 0.7037, AUC: 0.7056
测试（本轮） - Acc: 0.3947, F1: 0.5490, AUC: 0.6023 , Recall: 0.8750, Precision: 0.4000

Epoch 96/100
------------------------------------------------------------

训练 - Loss: 0.6998, Acc: 0.4737
验证 - Loss: 0.6355, Acc: 0.6053, F1: 0.7273, AUC: 0.6583
测试（本轮） - Acc: 0.3947, F1: 0.5660, AUC: 0.5852 , Recall: 0.9375, Precision: 0.4054

Epoch 97/100
------------------------------------------------------------

训练 - Loss: 0.6810, Acc: 0.5033
验证 - Loss: 0.6537, Acc: 0.5789, F1: 0.7143, AUC: 0.6806
测试（本轮） - Acc: 0.5000, F1: 0.6275, AUC: 0.6591 , Recall: 1.0000, Precision: 0.4571

Epoch 98/100
------------------------------------------------------------

训练 - Loss: 0.6932, Acc: 0.4638
验证 - Loss: 0.6409, Acc: 0.6053, F1: 0.7273, AUC: 0.6583
测试（本轮） - Acc: 0.3684, F1: 0.5385, AUC: 0.5966 , Recall: 0.8750, Precision: 0.3889

Epoch 99/100
------------------------------------------------------------

训练 - Loss: 0.6884, Acc: 0.4934
验证 - Loss: 0.6508, Acc: 0.6316, F1: 0.7407, AUC: 0.6917
测试（本轮） - Acc: 0.4211, F1: 0.5600, AUC: 0.6335 , Recall: 0.8750, Precision: 0.4118

Epoch 100/100
------------------------------------------------------------

训练 - Loss: 0.6920, Acc: 0.5164
验证 - Loss: 0.6461, Acc: 0.6053, F1: 0.7273, AUC: 0.6611
测试（本轮） - Acc: 0.3684, F1: 0.5385, AUC: 0.6250 , Recall: 0.8750, Precision: 0.3889

✓ 训练历史已保存: ./output/train_20251222_193941/logs/training_history.csv
✓ Loss对比图已保存: ./output/train_20251222_193941/logs/loss_comparison_4views.png

============================================================
Loss改善统计:
============================================================
训练集:
  初始Loss (Epoch 0):    35.9568
  最佳Loss (Epoch 1+):   0.6756
  改善:                  35.2812 (98.1%)

验证集:
  初始Loss (Epoch 0):    40.6454
  最佳Loss (Epoch 1+):   0.5501
  改善:                  40.0953 (98.6%)
============================================================


============================================================
测试集评估...
============================================================

测试集结果:
  准确率: 0.6842
  精确率: 0.6000
  召回率: 0.7500
  F1分数: 0.6667
  AUC:   0.7330

混淆矩阵:
[[14  8]
 [ 4 12]]

============================================================
保存测试集详细预测结果...
============================================================

正在评估测试集每个样本...
  已评估 5/38 个样本
  已评估 10/38 个样本
  已评估 15/38 个样本
  已评估 20/38 个样本
  已评估 25/38 个样本
  已评估 30/38 个样本
  已评估 35/38 个样本

✓ 测试集详细评估完成
  总样本数: 38
  正确预测: 26
  错误预测: 12
  准确率: 0.6842

✓ 详细预测结果已保存: ./output/train_20251222_193941/results/test_predictions_detailed.csv
✓ 错误预测案例已保存: ./output/train_20251222_193941/results/test_predictions_errors.csv

错误预测详情:
  - 熊彦会: 真实=0, 预测=1, 置信度=0.888
  - 万强: 真实=1, 预测=0, 置信度=0.502
  - 李登华: 真实=0, 预测=1, 置信度=0.642
  - 袁政: 真实=0, 预测=1, 置信度=0.551
  - 丁修华: 真实=1, 预测=0, 置信度=0.500
  - 葛孝英: 真实=0, 预测=1, 置信度=0.650
  - 李双京: 真实=1, 预测=0, 置信度=0.501
  - 张德民: 真实=0, 预测=1, 置信度=0.502
  - 杨振华: 真实=0, 预测=1, 置信度=0.541
  - 刘巧真: 真实=0, 预测=1, 置信度=0.726
  - 顾文勇: 真实=0, 预测=1, 置信度=0.777
  - 谢宝康: 真实=1, 预测=0, 置信度=0.506

============================================================
测试集详细结果文件:
  - test_predictions_detailed.csv (所有样本)
  - test_predictions_errors.csv (仅错误预测)
============================================================

============================================================
训练完成！所有结果保存在: ./output/train_20251222_193941
============================================================