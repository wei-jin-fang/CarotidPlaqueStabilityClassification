使用设备: cuda
✓ 随机种子设置为: 42

✓ 创建输出文件夹: ./output_mask/train_mask_20251223_210453


============================================================
加载数据集（含Mask）...
============================================================
跳过 孙宝忠: 不在标签文件中
跳过 谢岐山: 不在标签文件中
跳过 陈会友: 不在标签文件中
跳过 朱岳平: 不在标签文件中
跳过 眭卫国: 不在标签文件中
============================================================
数据加载统计 (含Mask):
============================================================
✓ 成功加载: 380 个样本
✗ 跳过样本: 2 个 (图片数 < 100)
✗ 缺少Mask: 0 个
每个样本保留: 100 张图片

跳过的样本详情:
  ✗ 王翠霞            :   96 张 | Label: 1
  ✗ 赵明庚            :   67 张 | Label: 0

类别分布: Label 0: 209 个  Label 1: 171 个  
============================================================

数据集划分:
  训练集: 304 样本
  验证集: 38 样本
  测试集: 38 样本

============================================================
保存数据集样本名称...
============================================================
✓ 训练集样本已保存: ./output_mask/train_mask_20251223_210453/logs/train_samples.csv (304 样本)
✓ 验证集样本已保存: ./output_mask/train_mask_20251223_210453/logs/val_samples.csv (38 样本)
✓ 测试集样本已保存: ./output_mask/train_mask_20251223_210453/logs/test_samples.csv (38 样本)
============================================================


============================================================
创建Mask引导模型...
============================================================
正在加载预训练模型: ./weights/resnet_18_23dataset.pth
✓ 成功加载 102 个预训练权重
冻结骨干网络参数...
✓ 冻结了 60 个参数
可训练参数: 165,250 / 33,325,250 (0.50%)
类别分布: 负类=169, 正类=135
基础权重: [0.8994082840236687, 1.125925925925926]
最终权重: [0.8994083 1.351111 ] (neg_scale=1.0, pos_scale=1.2)

============================================================
评估第0轮（初始）性能...
============================================================
第0轮（初始）:
  训练集 Loss: 57.7412
  验证集 Loss: 65.6483
  验证集 Acc:  0.4737
============================================================


============================================================
开始训练...
============================================================


Epoch 1/100
------------------------------------------------------------

训练 - Loss: 6.0441, Acc: 0.4375
验证 - Loss: 1.2770, Acc: 0.4737, F1: 0.0000, AUC: 0.3556
测试（本轮） - Acc: 0.5789, F1: 0.0000, AUC: 0.4602, Recall: 0.0000, Precision: 0.0000
✓ 保存最佳模型 (验证准确率: 0.4737)

Epoch 2/100
------------------------------------------------------------

训练 - Loss: 4.0856, Acc: 0.5164
验证 - Loss: 0.9652, Acc: 0.5789, F1: 0.6667, AUC: 0.6694
测试（本轮） - Acc: 0.4737, F1: 0.5652, AUC: 0.5000, Recall: 0.8125, Precision: 0.4333
✓ 保存最佳模型 (验证准确率: 0.5789)

Epoch 3/100
------------------------------------------------------------

训练 - Loss: 3.9095, Acc: 0.5066
验证 - Loss: 1.8735, Acc: 0.5789, F1: 0.6364, AUC: 0.4472
测试（本轮） - Acc: 0.5000, F1: 0.3871, AUC: 0.4489, Recall: 0.3750, Precision: 0.4000

Epoch 4/100
------------------------------------------------------------

训练 - Loss: 3.3924, Acc: 0.5066
验证 - Loss: 1.0514, Acc: 0.5263, F1: 0.3077, AUC: 0.4917
测试（本轮） - Acc: 0.6053, F1: 0.4828, AUC: 0.5994, Recall: 0.4375, Precision: 0.5385

Epoch 5/100
------------------------------------------------------------

训练 - Loss: 2.5034, Acc: 0.5559
验证 - Loss: 1.1128, Acc: 0.5526, F1: 0.6667, AUC: 0.5917
测试（本轮） - Acc: 0.4737, F1: 0.5455, AUC: 0.4915, Recall: 0.7500, Precision: 0.4286

Epoch 6/100
------------------------------------------------------------

训练 - Loss: 2.6442, Acc: 0.4770
验证 - Loss: 0.8048, Acc: 0.5789, F1: 0.6923, AUC: 0.6056
测试（本轮） - Acc: 0.5000, F1: 0.5957, AUC: 0.5085, Recall: 0.8750, Precision: 0.4516

Epoch 7/100
------------------------------------------------------------

训练 - Loss: 2.3928, Acc: 0.5066
验证 - Loss: 1.1254, Acc: 0.6053, F1: 0.6809, AUC: 0.5889
测试（本轮） - Acc: 0.5000, F1: 0.4571, AUC: 0.4545, Recall: 0.5000, Precision: 0.4211
✓ 保存最佳模型 (验证准确率: 0.6053)

Epoch 8/100
------------------------------------------------------------

训练 - Loss: 1.8165, Acc: 0.4967
验证 - Loss: 1.3646, Acc: 0.4737, F1: 0.0000, AUC: 0.3556
测试（本轮） - Acc: 0.5789, F1: 0.0000, AUC: 0.3097, Recall: 0.0000, Precision: 0.0000

Epoch 9/100
------------------------------------------------------------

训练 - Loss: 1.5509, Acc: 0.5000
验证 - Loss: 1.0828, Acc: 0.5000, F1: 0.2963, AUC: 0.3139
测试（本轮） - Acc: 0.6579, F1: 0.5185, AUC: 0.6562, Recall: 0.4375, Precision: 0.6364

Epoch 10/100
------------------------------------------------------------

训练 - Loss: 1.7627, Acc: 0.5000
验证 - Loss: 0.8890, Acc: 0.4737, F1: 0.5455, AUC: 0.4278
测试（本轮） - Acc: 0.6842, F1: 0.6471, AUC: 0.6648, Recall: 0.6875, Precision: 0.6111

Epoch 11/100
------------------------------------------------------------

训练 - Loss: 1.2761, Acc: 0.4934
验证 - Loss: 0.7943, Acc: 0.5526, F1: 0.5854, AUC: 0.5611
测试（本轮） - Acc: 0.6579, F1: 0.5517, AUC: 0.7017, Recall: 0.5000, Precision: 0.6154

Epoch 12/100
------------------------------------------------------------

训练 - Loss: 1.1779, Acc: 0.5428
验证 - Loss: 0.7875, Acc: 0.5263, F1: 0.6087, AUC: 0.4861
测试（本轮） - Acc: 0.6053, F1: 0.5714, AUC: 0.6307, Recall: 0.6250, Precision: 0.5263

Epoch 13/100
------------------------------------------------------------

训练 - Loss: 1.1858, Acc: 0.5296
验证 - Loss: 0.8286, Acc: 0.4474, F1: 0.4878, AUC: 0.4417
测试（本轮） - Acc: 0.6316, F1: 0.6316, AUC: 0.6364, Recall: 0.7500, Precision: 0.5455

Epoch 14/100
------------------------------------------------------------

训练 - Loss: 1.0696, Acc: 0.5132
验证 - Loss: 0.6821, Acc: 0.6579, F1: 0.7451, AUC: 0.6611
测试（本轮） - Acc: 0.5789, F1: 0.6364, AUC: 0.5938, Recall: 0.8750, Precision: 0.5000
✓ 保存最佳模型 (验证准确率: 0.6579)

Epoch 15/100
------------------------------------------------------------

训练 - Loss: 0.9679, Acc: 0.5197
验证 - Loss: 0.7411, Acc: 0.4211, F1: 0.4211, AUC: 0.4278
测试（本轮） - Acc: 0.4737, F1: 0.2857, AUC: 0.3892, Recall: 0.2500, Precision: 0.3333

Epoch 16/100
------------------------------------------------------------

训练 - Loss: 0.8876, Acc: 0.5033
验证 - Loss: 0.6670, Acc: 0.4737, F1: 0.6154, AUC: 0.5944
测试（本轮） - Acc: 0.3947, F1: 0.4390, AUC: 0.4773, Recall: 0.5625, Precision: 0.3600

Epoch 17/100
------------------------------------------------------------

训练 - Loss: 0.9199, Acc: 0.4836
验证 - Loss: 0.7067, Acc: 0.4737, F1: 0.5833, AUC: 0.4694
测试（本轮） - Acc: 0.6053, F1: 0.5161, AUC: 0.5142, Recall: 0.5000, Precision: 0.5333

Epoch 18/100
------------------------------------------------------------

训练 - Loss: 0.9230, Acc: 0.4704
验证 - Loss: 0.6852, Acc: 0.5526, F1: 0.6222, AUC: 0.5611
测试（本轮） - Acc: 0.5263, F1: 0.3077, AUC: 0.4744, Recall: 0.2500, Precision: 0.4000

Epoch 19/100
------------------------------------------------------------

训练 - Loss: 0.8438, Acc: 0.4638
验证 - Loss: 0.6730, Acc: 0.5526, F1: 0.6531, AUC: 0.5611
测试（本轮） - Acc: 0.3947, F1: 0.3784, AUC: 0.4460, Recall: 0.4375, Precision: 0.3333

Epoch 20/100
------------------------------------------------------------

训练 - Loss: 0.7595, Acc: 0.4868
验证 - Loss: 0.6601, Acc: 0.5789, F1: 0.7037, AUC: 0.6611
测试（本轮） - Acc: 0.4474, F1: 0.5116, AUC: 0.5256, Recall: 0.6875, Precision: 0.4074

Epoch 21/100
------------------------------------------------------------

训练 - Loss: 0.8126, Acc: 0.4375
验证 - Loss: 0.6743, Acc: 0.6842, F1: 0.7143, AUC: 0.6583
测试（本轮） - Acc: 0.6842, F1: 0.6000, AUC: 0.6392, Recall: 0.5625, Precision: 0.6429
✓ 保存最佳模型 (验证准确率: 0.6842)

Epoch 22/100
------------------------------------------------------------

训练 - Loss: 0.7482, Acc: 0.5329
验证 - Loss: 0.6928, Acc: 0.5789, F1: 0.6364, AUC: 0.6028
测试（本轮） - Acc: 0.5263, F1: 0.3571, AUC: 0.4233, Recall: 0.3125, Precision: 0.4167

Epoch 23/100
------------------------------------------------------------

训练 - Loss: 0.7474, Acc: 0.4901
验证 - Loss: 0.6807, Acc: 0.5263, F1: 0.6400, AUC: 0.5056
测试（本轮） - Acc: 0.5263, F1: 0.4706, AUC: 0.5824, Recall: 0.5000, Precision: 0.4444

Epoch 24/100
------------------------------------------------------------

训练 - Loss: 0.7301, Acc: 0.5296
验证 - Loss: 0.6848, Acc: 0.5263, F1: 0.6538, AUC: 0.5500
测试（本轮） - Acc: 0.5000, F1: 0.4571, AUC: 0.5284, Recall: 0.5000, Precision: 0.4211

Epoch 25/100
------------------------------------------------------------

训练 - Loss: 0.7635, Acc: 0.4507
验证 - Loss: 0.6882, Acc: 0.6053, F1: 0.6667, AUC: 0.5944
测试（本轮） - Acc: 0.5263, F1: 0.5263, AUC: 0.5938, Recall: 0.6250, Precision: 0.4545

Epoch 26/100
------------------------------------------------------------

训练 - Loss: 0.7024, Acc: 0.5395
验证 - Loss: 0.6946, Acc: 0.5789, F1: 0.6522, AUC: 0.6167
测试（本轮） - Acc: 0.5000, F1: 0.4865, AUC: 0.6136, Recall: 0.5625, Precision: 0.4286

Epoch 27/100
------------------------------------------------------------

训练 - Loss: 0.7388, Acc: 0.4671
验证 - Loss: 0.7100, Acc: 0.4737, F1: 0.6000, AUC: 0.4694
测试（本轮） - Acc: 0.4474, F1: 0.4000, AUC: 0.4176, Recall: 0.4375, Precision: 0.3684

Epoch 28/100
------------------------------------------------------------

训练 - Loss: 0.7156, Acc: 0.5526
验证 - Loss: 0.6783, Acc: 0.5263, F1: 0.6400, AUC: 0.5333
测试（本轮） - Acc: 0.5526, F1: 0.5143, AUC: 0.4716, Recall: 0.5625, Precision: 0.4737

Epoch 29/100
------------------------------------------------------------

训练 - Loss: 0.6987, Acc: 0.5461
验证 - Loss: 0.6801, Acc: 0.5526, F1: 0.6792, AUC: 0.5750
测试（本轮） - Acc: 0.4474, F1: 0.5116, AUC: 0.5824, Recall: 0.6875, Precision: 0.4074

Epoch 30/100
------------------------------------------------------------

训练 - Loss: 0.7115, Acc: 0.5230
验证 - Loss: 0.6748, Acc: 0.5526, F1: 0.6047, AUC: 0.5917
测试（本轮） - Acc: 0.6053, F1: 0.4444, AUC: 0.5142, Recall: 0.3750, Precision: 0.5455

Epoch 31/100
------------------------------------------------------------

训练 - Loss: 0.7294, Acc: 0.5230
验证 - Loss: 0.6739, Acc: 0.5789, F1: 0.6364, AUC: 0.5389
测试（本轮） - Acc: 0.5789, F1: 0.4286, AUC: 0.5653, Recall: 0.3750, Precision: 0.5000

Epoch 32/100
------------------------------------------------------------

训练 - Loss: 0.7362, Acc: 0.4671
验证 - Loss: 0.6920, Acc: 0.5263, F1: 0.6087, AUC: 0.4972
测试（本轮） - Acc: 0.5526, F1: 0.4516, AUC: 0.5000, Recall: 0.4375, Precision: 0.4667

Epoch 33/100
------------------------------------------------------------

训练 - Loss: 0.6873, Acc: 0.5493
验证 - Loss: 0.6933, Acc: 0.6053, F1: 0.6939, AUC: 0.5389
测试（本轮） - Acc: 0.5789, F1: 0.5294, AUC: 0.6392, Recall: 0.5625, Precision: 0.5000

Epoch 34/100
------------------------------------------------------------

训练 - Loss: 0.7273, Acc: 0.5526
验证 - Loss: 0.6594, Acc: 0.6842, F1: 0.7500, AUC: 0.6083
测试（本轮） - Acc: 0.5263, F1: 0.5500, AUC: 0.5994, Recall: 0.6875, Precision: 0.4583

Epoch 35/100
------------------------------------------------------------

训练 - Loss: 0.7246, Acc: 0.5066
验证 - Loss: 0.6702, Acc: 0.6053, F1: 0.7273, AUC: 0.5417
测试（本轮） - Acc: 0.5263, F1: 0.6087, AUC: 0.6534, Recall: 0.8750, Precision: 0.4667

Epoch 36/100
------------------------------------------------------------

训练 - Loss: 0.7129, Acc: 0.5066
验证 - Loss: 0.6702, Acc: 0.6053, F1: 0.7273, AUC: 0.5639
测试（本轮） - Acc: 0.5000, F1: 0.5778, AUC: 0.6222, Recall: 0.8125, Precision: 0.4483

Epoch 37/100
------------------------------------------------------------

训练 - Loss: 0.6970, Acc: 0.5066
验证 - Loss: 0.6739, Acc: 0.5789, F1: 0.6364, AUC: 0.5667
测试（本轮） - Acc: 0.6316, F1: 0.4615, AUC: 0.5881, Recall: 0.3750, Precision: 0.6000

Epoch 38/100
------------------------------------------------------------

训练 - Loss: 0.7261, Acc: 0.4934
验证 - Loss: 0.6884, Acc: 0.5000, F1: 0.6275, AUC: 0.4417
测试（本轮） - Acc: 0.5526, F1: 0.4848, AUC: 0.5511, Recall: 0.5000, Precision: 0.4706

Epoch 39/100
------------------------------------------------------------

训练 - Loss: 0.6943, Acc: 0.5263
验证 - Loss: 0.6934, Acc: 0.4474, F1: 0.5714, AUC: 0.4639
测试（本轮） - Acc: 0.5000, F1: 0.4242, AUC: 0.4489, Recall: 0.4375, Precision: 0.4118

Epoch 40/100
------------------------------------------------------------

训练 - Loss: 0.6896, Acc: 0.4836
验证 - Loss: 0.6692, Acc: 0.6053, F1: 0.7273, AUC: 0.6556
测试（本轮） - Acc: 0.4737, F1: 0.5833, AUC: 0.5511, Recall: 0.8750, Precision: 0.4375

Epoch 41/100
------------------------------------------------------------

训练 - Loss: 0.7126, Acc: 0.4836
验证 - Loss: 0.6708, Acc: 0.6316, F1: 0.7407, AUC: 0.7167
测试（本轮） - Acc: 0.4474, F1: 0.5714, AUC: 0.6108, Recall: 0.8750, Precision: 0.4242

Epoch 42/100
------------------------------------------------------------

训练 - Loss: 0.6970, Acc: 0.4704
验证 - Loss: 0.6794, Acc: 0.5526, F1: 0.7018, AUC: 0.5528
测试（本轮） - Acc: 0.4211, F1: 0.5926, AUC: 0.6023, Recall: 1.0000, Precision: 0.4211

Epoch 43/100
------------------------------------------------------------

训练 - Loss: 0.6927, Acc: 0.4737
验证 - Loss: 0.6726, Acc: 0.6316, F1: 0.7407, AUC: 0.7000
测试（本轮） - Acc: 0.4211, F1: 0.5600, AUC: 0.6250, Recall: 0.8750, Precision: 0.4118

Epoch 44/100
------------------------------------------------------------

训练 - Loss: 0.6950, Acc: 0.5099
验证 - Loss: 0.6563, Acc: 0.6316, F1: 0.7407, AUC: 0.7139
测试（本轮） - Acc: 0.4737, F1: 0.5833, AUC: 0.6534, Recall: 0.8750, Precision: 0.4375

Epoch 45/100
------------------------------------------------------------

训练 - Loss: 0.6915, Acc: 0.4704
验证 - Loss: 0.6788, Acc: 0.6053, F1: 0.7273, AUC: 0.6278
测试（本轮） - Acc: 0.5263, F1: 0.6250, AUC: 0.6648, Recall: 0.9375, Precision: 0.4688

Epoch 46/100
------------------------------------------------------------

训练 - Loss: 0.6835, Acc: 0.5197
验证 - Loss: 0.6843, Acc: 0.6053, F1: 0.6341, AUC: 0.6139
测试（本轮） - Acc: 0.6842, F1: 0.5385, AUC: 0.5909, Recall: 0.4375, Precision: 0.7000

Epoch 47/100
------------------------------------------------------------

训练 - Loss: 0.7072, Acc: 0.4901
验证 - Loss: 0.6830, Acc: 0.5526, F1: 0.6792, AUC: 0.5500
测试（本轮） - Acc: 0.4211, F1: 0.4500, AUC: 0.4688, Recall: 0.5625, Precision: 0.3750

Epoch 48/100
------------------------------------------------------------

训练 - Loss: 0.6992, Acc: 0.4770
验证 - Loss: 0.6802, Acc: 0.5789, F1: 0.7143, AUC: 0.5806
测试（本轮） - Acc: 0.4474, F1: 0.5333, AUC: 0.5767, Recall: 0.7500, Precision: 0.4138

Epoch 49/100
------------------------------------------------------------

训练 - Loss: 0.6880, Acc: 0.4572
验证 - Loss: 0.6751, Acc: 0.5263, F1: 0.6897, AUC: 0.5250
测试（本轮） - Acc: 0.4211, F1: 0.5926, AUC: 0.6080, Recall: 1.0000, Precision: 0.4211

Epoch 50/100
------------------------------------------------------------

训练 - Loss: 0.6895, Acc: 0.4638
验证 - Loss: 0.6758, Acc: 0.5263, F1: 0.6897, AUC: 0.6361
测试（本轮） - Acc: 0.3947, F1: 0.5660, AUC: 0.6136, Recall: 0.9375, Precision: 0.4054

Epoch 51/100
------------------------------------------------------------

训练 - Loss: 0.7040, Acc: 0.4605
验证 - Loss: 0.6814, Acc: 0.5000, F1: 0.6415, AUC: 0.4778
测试（本轮） - Acc: 0.5000, F1: 0.5778, AUC: 0.5483, Recall: 0.8125, Precision: 0.4483

Epoch 52/100
------------------------------------------------------------

训练 - Loss: 0.6989, Acc: 0.4572
验证 - Loss: 0.6848, Acc: 0.5000, F1: 0.6122, AUC: 0.4194
测试（本轮） - Acc: 0.5526, F1: 0.5405, AUC: 0.5341, Recall: 0.6250, Precision: 0.4762

Epoch 53/100
------------------------------------------------------------

训练 - Loss: 0.6821, Acc: 0.5000
验证 - Loss: 0.6802, Acc: 0.5263, F1: 0.6538, AUC: 0.5556
测试（本轮） - Acc: 0.4737, F1: 0.5455, AUC: 0.5909, Recall: 0.7500, Precision: 0.4286

Epoch 54/100
------------------------------------------------------------

训练 - Loss: 0.6945, Acc: 0.4375
验证 - Loss: 0.6789, Acc: 0.5526, F1: 0.7018, AUC: 0.4611
测试（本轮） - Acc: 0.4474, F1: 0.5714, AUC: 0.5682, Recall: 0.8750, Precision: 0.4242

Epoch 55/100
------------------------------------------------------------

训练 - Loss: 0.6902, Acc: 0.4934
验证 - Loss: 0.6769, Acc: 0.5526, F1: 0.7018, AUC: 0.5472
测试（本轮） - Acc: 0.4211, F1: 0.5217, AUC: 0.5710, Recall: 0.7500, Precision: 0.4000

Epoch 56/100
------------------------------------------------------------

训练 - Loss: 0.6957, Acc: 0.4770
验证 - Loss: 0.6751, Acc: 0.5000, F1: 0.6415, AUC: 0.5778
测试（本轮） - Acc: 0.4737, F1: 0.5455, AUC: 0.5994, Recall: 0.7500, Precision: 0.4286

Epoch 57/100
------------------------------------------------------------

训练 - Loss: 0.6770, Acc: 0.4737
验证 - Loss: 0.6760, Acc: 0.5000, F1: 0.6415, AUC: 0.5111
测试（本轮） - Acc: 0.5000, F1: 0.5778, AUC: 0.6080, Recall: 0.8125, Precision: 0.4483

Epoch 58/100
------------------------------------------------------------

训练 - Loss: 0.6878, Acc: 0.4901
验证 - Loss: 0.6794, Acc: 0.5263, F1: 0.6897, AUC: 0.4944
测试（本轮） - Acc: 0.4737, F1: 0.6154, AUC: 0.6193, Recall: 1.0000, Precision: 0.4444

Epoch 59/100
------------------------------------------------------------

训练 - Loss: 0.6945, Acc: 0.4507
验证 - Loss: 0.6950, Acc: 0.5526, F1: 0.6792, AUC: 0.5667
测试（本轮） - Acc: 0.3947, F1: 0.4390, AUC: 0.3835, Recall: 0.5625, Precision: 0.3600

Epoch 60/100
------------------------------------------------------------

训练 - Loss: 0.6962, Acc: 0.4770
验证 - Loss: 0.6792, Acc: 0.4737, F1: 0.6429, AUC: 0.5167
测试（本轮） - Acc: 0.3421, F1: 0.4898, AUC: 0.3864, Recall: 0.7500, Precision: 0.3636

Epoch 61/100
------------------------------------------------------------

训练 - Loss: 0.6951, Acc: 0.4507
验证 - Loss: 0.6750, Acc: 0.5526, F1: 0.7018, AUC: 0.5111
测试（本轮） - Acc: 0.3947, F1: 0.5306, AUC: 0.5284, Recall: 0.8125, Precision: 0.3939

Epoch 62/100
------------------------------------------------------------

训练 - Loss: 0.6901, Acc: 0.4901
验证 - Loss: 0.6708, Acc: 0.5789, F1: 0.7143, AUC: 0.5500
测试（本轮） - Acc: 0.4211, F1: 0.5600, AUC: 0.5227, Recall: 0.8750, Precision: 0.4118

Epoch 63/100
------------------------------------------------------------

训练 - Loss: 0.6849, Acc: 0.5000
验证 - Loss: 0.6738, Acc: 0.5789, F1: 0.7143, AUC: 0.6194
测试（本轮） - Acc: 0.4474, F1: 0.5714, AUC: 0.6136, Recall: 0.8750, Precision: 0.4242

Epoch 64/100
------------------------------------------------------------

训练 - Loss: 0.6874, Acc: 0.4901
验证 - Loss: 0.6828, Acc: 0.6053, F1: 0.7273, AUC: 0.5750
测试（本轮） - Acc: 0.4737, F1: 0.5833, AUC: 0.6278, Recall: 0.8750, Precision: 0.4375

Epoch 65/100
------------------------------------------------------------

训练 - Loss: 0.6722, Acc: 0.5395
验证 - Loss: 0.6760, Acc: 0.6316, F1: 0.7308, AUC: 0.6667
测试（本轮） - Acc: 0.5263, F1: 0.5500, AUC: 0.5994, Recall: 0.6875, Precision: 0.4583

Epoch 66/100
------------------------------------------------------------

训练 - Loss: 0.6902, Acc: 0.4934
验证 - Loss: 0.6787, Acc: 0.6053, F1: 0.6939, AUC: 0.7139
测试（本轮） - Acc: 0.5789, F1: 0.5789, AUC: 0.6023, Recall: 0.6875, Precision: 0.5000

Epoch 67/100
------------------------------------------------------------

训练 - Loss: 0.6851, Acc: 0.5033
验证 - Loss: 0.6843, Acc: 0.5789, F1: 0.6800, AUC: 0.5444
测试（本轮） - Acc: 0.5526, F1: 0.5641, AUC: 0.5824, Recall: 0.6875, Precision: 0.4783

Epoch 68/100
------------------------------------------------------------

训练 - Loss: 0.6956, Acc: 0.4967
验证 - Loss: 0.6776, Acc: 0.6053, F1: 0.6939, AUC: 0.5472
测试（本轮） - Acc: 0.5526, F1: 0.5405, AUC: 0.5540, Recall: 0.6250, Precision: 0.4762

Epoch 69/100
------------------------------------------------------------

训练 - Loss: 0.6936, Acc: 0.4934
验证 - Loss: 0.6799, Acc: 0.5526, F1: 0.6531, AUC: 0.4361
测试（本轮） - Acc: 0.5000, F1: 0.4571, AUC: 0.4631, Recall: 0.5000, Precision: 0.4211

Epoch 70/100
------------------------------------------------------------

训练 - Loss: 0.6828, Acc: 0.5066
验证 - Loss: 0.6808, Acc: 0.5789, F1: 0.6800, AUC: 0.5417
测试（本轮） - Acc: 0.5526, F1: 0.5405, AUC: 0.5739, Recall: 0.6250, Precision: 0.4762

Epoch 71/100
------------------------------------------------------------

训练 - Loss: 0.6927, Acc: 0.4737
验证 - Loss: 0.6829, Acc: 0.5000, F1: 0.6122, AUC: 0.4417
测试（本轮） - Acc: 0.5000, F1: 0.4242, AUC: 0.4403, Recall: 0.4375, Precision: 0.4118

Epoch 72/100
------------------------------------------------------------

训练 - Loss: 0.6832, Acc: 0.5164
验证 - Loss: 0.6784, Acc: 0.5263, F1: 0.6250, AUC: 0.4611
测试（本轮） - Acc: 0.5263, F1: 0.4375, AUC: 0.4915, Recall: 0.4375, Precision: 0.4375

Epoch 73/100
------------------------------------------------------------

训练 - Loss: 0.6951, Acc: 0.4803
验证 - Loss: 0.6746, Acc: 0.5526, F1: 0.6792, AUC: 0.5028
测试（本轮） - Acc: 0.3947, F1: 0.3784, AUC: 0.4460, Recall: 0.4375, Precision: 0.3333

Epoch 74/100
------------------------------------------------------------

训练 - Loss: 0.6751, Acc: 0.5230
验证 - Loss: 0.6767, Acc: 0.5789, F1: 0.6800, AUC: 0.5611
测试（本轮） - Acc: 0.5000, F1: 0.4865, AUC: 0.5540, Recall: 0.5625, Precision: 0.4286

Epoch 75/100
------------------------------------------------------------

训练 - Loss: 0.6803, Acc: 0.4967
验证 - Loss: 0.6805, Acc: 0.5789, F1: 0.6800, AUC: 0.5306
测试（本轮） - Acc: 0.5263, F1: 0.5263, AUC: 0.5426, Recall: 0.6250, Precision: 0.4545

Epoch 76/100
------------------------------------------------------------

训练 - Loss: 0.6913, Acc: 0.5230
验证 - Loss: 0.6694, Acc: 0.6053, F1: 0.6809, AUC: 0.6056
测试（本轮） - Acc: 0.5000, F1: 0.5128, AUC: 0.5710, Recall: 0.6250, Precision: 0.4348

Epoch 77/100
------------------------------------------------------------

训练 - Loss: 0.6991, Acc: 0.4967
验证 - Loss: 0.6773, Acc: 0.5263, F1: 0.6250, AUC: 0.5083
测试（本轮） - Acc: 0.5000, F1: 0.4571, AUC: 0.5227, Recall: 0.5000, Precision: 0.4211

Epoch 78/100
------------------------------------------------------------

训练 - Loss: 0.6896, Acc: 0.4934
验证 - Loss: 0.6783, Acc: 0.6053, F1: 0.6939, AUC: 0.5528
测试（本轮） - Acc: 0.5526, F1: 0.5641, AUC: 0.5653, Recall: 0.6875, Precision: 0.4783

Epoch 79/100
------------------------------------------------------------

训练 - Loss: 0.6843, Acc: 0.5132
验证 - Loss: 0.6767, Acc: 0.5789, F1: 0.6667, AUC: 0.5333
测试（本轮） - Acc: 0.5000, F1: 0.4865, AUC: 0.5114, Recall: 0.5625, Precision: 0.4286

Epoch 80/100
------------------------------------------------------------

训练 - Loss: 0.6907, Acc: 0.4967
验证 - Loss: 0.6775, Acc: 0.5789, F1: 0.6667, AUC: 0.5500
测试（本轮） - Acc: 0.5526, F1: 0.5143, AUC: 0.5369, Recall: 0.5625, Precision: 0.4737

Epoch 81/100
------------------------------------------------------------

训练 - Loss: 0.6943, Acc: 0.4901
验证 - Loss: 0.6767, Acc: 0.5789, F1: 0.6800, AUC: 0.5083
测试（本轮） - Acc: 0.5263, F1: 0.5263, AUC: 0.5597, Recall: 0.6250, Precision: 0.4545

Epoch 82/100
------------------------------------------------------------

训练 - Loss: 0.6870, Acc: 0.5033
验证 - Loss: 0.6761, Acc: 0.5526, F1: 0.6792, AUC: 0.5111
测试（本轮） - Acc: 0.4737, F1: 0.4737, AUC: 0.4943, Recall: 0.5625, Precision: 0.4091

Epoch 83/100
------------------------------------------------------------

训练 - Loss: 0.6886, Acc: 0.4868
验证 - Loss: 0.6802, Acc: 0.5789, F1: 0.6800, AUC: 0.4694
测试（本轮） - Acc: 0.5263, F1: 0.5263, AUC: 0.5540, Recall: 0.6250, Precision: 0.4545

Epoch 84/100
------------------------------------------------------------

训练 - Loss: 0.6833, Acc: 0.5263
验证 - Loss: 0.6739, Acc: 0.6053, F1: 0.6939, AUC: 0.5917
测试（本轮） - Acc: 0.5263, F1: 0.5000, AUC: 0.5739, Recall: 0.5625, Precision: 0.4500

Epoch 85/100
------------------------------------------------------------

训练 - Loss: 0.6797, Acc: 0.5526
验证 - Loss: 0.6774, Acc: 0.5789, F1: 0.7143, AUC: 0.4861
测试（本轮） - Acc: 0.4474, F1: 0.5333, AUC: 0.5114, Recall: 0.7500, Precision: 0.4138

Epoch 86/100
------------------------------------------------------------

训练 - Loss: 0.6814, Acc: 0.5099
验证 - Loss: 0.6726, Acc: 0.6316, F1: 0.7407, AUC: 0.5806
测试（本轮） - Acc: 0.5000, F1: 0.5366, AUC: 0.5540, Recall: 0.6875, Precision: 0.4400

Epoch 87/100
------------------------------------------------------------

训练 - Loss: 0.6820, Acc: 0.5263
验证 - Loss: 0.6748, Acc: 0.5526, F1: 0.6792, AUC: 0.4833
测试（本轮） - Acc: 0.4474, F1: 0.4878, AUC: 0.5256, Recall: 0.6250, Precision: 0.4000

Epoch 88/100
------------------------------------------------------------

训练 - Loss: 0.6832, Acc: 0.5428
验证 - Loss: 0.6779, Acc: 0.6053, F1: 0.7273, AUC: 0.4861
测试（本轮） - Acc: 0.5000, F1: 0.5128, AUC: 0.5540, Recall: 0.6250, Precision: 0.4348

Epoch 89/100
------------------------------------------------------------

训练 - Loss: 0.6756, Acc: 0.4967
验证 - Loss: 0.6774, Acc: 0.6316, F1: 0.7407, AUC: 0.4972
测试（本轮） - Acc: 0.4737, F1: 0.5000, AUC: 0.5710, Recall: 0.6250, Precision: 0.4167

Epoch 90/100
------------------------------------------------------------

训练 - Loss: 0.6866, Acc: 0.5132
验证 - Loss: 0.6750, Acc: 0.5789, F1: 0.6800, AUC: 0.5139
测试（本轮） - Acc: 0.5526, F1: 0.5405, AUC: 0.5511, Recall: 0.6250, Precision: 0.4762

Epoch 91/100
------------------------------------------------------------

训练 - Loss: 0.6917, Acc: 0.4770
验证 - Loss: 0.6771, Acc: 0.6053, F1: 0.7059, AUC: 0.5222
测试（本轮） - Acc: 0.5263, F1: 0.5500, AUC: 0.5597, Recall: 0.6875, Precision: 0.4583

Epoch 92/100
------------------------------------------------------------

训练 - Loss: 0.6854, Acc: 0.5066
验证 - Loss: 0.6718, Acc: 0.6053, F1: 0.6939, AUC: 0.5750
测试（本轮） - Acc: 0.5000, F1: 0.5128, AUC: 0.5426, Recall: 0.6250, Precision: 0.4348

Epoch 93/100
------------------------------------------------------------

训练 - Loss: 0.6853, Acc: 0.4836
验证 - Loss: 0.6760, Acc: 0.5789, F1: 0.6800, AUC: 0.4639
测试（本轮） - Acc: 0.6053, F1: 0.5714, AUC: 0.6136, Recall: 0.6250, Precision: 0.5263

Epoch 94/100
------------------------------------------------------------

训练 - Loss: 0.6837, Acc: 0.5296
验证 - Loss: 0.6714, Acc: 0.6053, F1: 0.7170, AUC: 0.5444
测试（本轮） - Acc: 0.5263, F1: 0.5000, AUC: 0.5625, Recall: 0.5625, Precision: 0.4500

Epoch 95/100
------------------------------------------------------------

训练 - Loss: 0.6851, Acc: 0.4967
验证 - Loss: 0.6740, Acc: 0.6579, F1: 0.7451, AUC: 0.5472
测试（本轮） - Acc: 0.5000, F1: 0.4865, AUC: 0.5597, Recall: 0.5625, Precision: 0.4286

Epoch 96/100
------------------------------------------------------------

训练 - Loss: 0.6916, Acc: 0.4934
验证 - Loss: 0.6717, Acc: 0.6316, F1: 0.7407, AUC: 0.5667
测试（本轮） - Acc: 0.4474, F1: 0.4615, AUC: 0.5540, Recall: 0.5625, Precision: 0.3913

Epoch 97/100
------------------------------------------------------------

训练 - Loss: 0.6757, Acc: 0.5428
验证 - Loss: 0.6764, Acc: 0.5526, F1: 0.6531, AUC: 0.4444
测试（本轮） - Acc: 0.5789, F1: 0.5556, AUC: 0.5568, Recall: 0.6250, Precision: 0.5000

Epoch 98/100
------------------------------------------------------------

训练 - Loss: 0.6884, Acc: 0.5033
验证 - Loss: 0.6746, Acc: 0.5789, F1: 0.6923, AUC: 0.5306
测试（本轮） - Acc: 0.4737, F1: 0.4444, AUC: 0.5540, Recall: 0.5000, Precision: 0.4000

Epoch 99/100
------------------------------------------------------------

训练 - Loss: 0.6868, Acc: 0.5132
验证 - Loss: 0.6755, Acc: 0.6053, F1: 0.7273, AUC: 0.4889
测试（本轮） - Acc: 0.4737, F1: 0.5455, AUC: 0.5511, Recall: 0.7500, Precision: 0.4286

Epoch 100/100
------------------------------------------------------------

训练 - Loss: 0.6817, Acc: 0.4901
验证 - Loss: 0.6765, Acc: 0.6053, F1: 0.7059, AUC: 0.5306
测试（本轮） - Acc: 0.4737, F1: 0.4737, AUC: 0.5795, Recall: 0.5625, Precision: 0.4091

✓ 训练历史已保存: ./output_mask/train_mask_20251223_210453/logs/training_history.csv
✓ Loss对比图已保存: ./output_mask/train_mask_20251223_210453/logs/loss_comparison_4views.png

============================================================
Loss改善统计:
============================================================
训练集:
  初始Loss (Epoch 0):    57.7412
  最佳Loss (Epoch 1+):   0.6722
  改善:                  57.0690 (98.8%)

验证集:
  初始Loss (Epoch 0):    65.6483
  最佳Loss (Epoch 1+):   0.6563
  改善:                  64.9919 (99.0%)
============================================================


============================================================
测试集评估...
============================================================

测试集结果:
  准确率: 0.6842
  精确率: 0.6429
  召回率: 0.5625
  F1分数: 0.6000
  AUC:   0.6392

混淆矩阵:
[[17  5]
 [ 7  9]]

============================================================
保存测试集详细预测结果...
============================================================

正在评估测试集每个样本...
  已评估 5/38 个样本
  已评估 10/38 个样本
  已评估 15/38 个样本
  已评估 20/38 个样本
  已评估 25/38 个样本
  已评估 30/38 个样本
  已评估 35/38 个样本

✓ 测试集详细评估完成
  总样本数: 38
  正确预测: 26
  错误预测: 12
  准确率: 0.6842

✓ 详细预测结果已保存: ./output_mask/train_mask_20251223_210453/results/test_predictions_detailed.csv
✓ 错误预测案例已保存: ./output_mask/train_mask_20251223_210453/results/test_predictions_errors.csv

错误预测详情:
  - 熊彦会: 真实=0, 预测=1, 置信度=0.859
  - 万强: 真实=1, 预测=0, 置信度=0.567
  - 李登华: 真实=0, 预测=1, 置信度=0.503
  - 梁啟华: 真实=0, 预测=1, 置信度=0.538
  - 周宏: 真实=1, 预测=0, 置信度=0.541
  - 肖发祥: 真实=1, 预测=0, 置信度=0.564
  - 王广礼: 真实=1, 预测=0, 置信度=0.570
  - 李双京: 真实=1, 预测=0, 置信度=0.531
  - 李忠信: 真实=0, 预测=1, 置信度=0.553
  - 尹卫国: 真实=1, 预测=0, 置信度=0.528
  - 顾文勇: 真实=0, 预测=1, 置信度=0.562
  - 谢宝康: 真实=1, 预测=0, 置信度=0.567

============================================================
测试集详细结果文件:
  - test_predictions_detailed.csv (所有样本)
  - test_predictions_errors.csv (仅错误预测)
============================================================

============================================================
训练完成！所有结果保存在: ./output_mask/train_mask_20251223_210453
============================================================